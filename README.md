# mlserve

`mlserve` is a Python library that helps you package your Machine Learning model easily into a REST API.

The idea behind `mlserve` is to define a set of generic endpoints to enable predictions

## Documentation

You can find the full documentation here : 

## How to use ? 

### Prerequisites 

Have a MlFlow server running, in order to have one on your local setup : 

```bash
mlflow server --backend-store-uri sqlite:///database.db --default-artifact-root file:///app/ --host 0.0.0.0 &
```

### Instructions

First of all, you need to have a model already trained and registered in MlFlow

Luckily for you, we already have a set of examples that you can already use.

To train a scikit-learn model and register it in MlFlow : 

```bash
curl -O https://github.com/gfalcone/mlserve/blob/master/examples/training/sklearn.py
python -m sklearn
```

Then you can define your api with this python file (name it `api.py`)

```python
from mlserve.api import ApiBuilder
from mlserve.loader import load_mlflow_model
from mlserve.predictions import GenericPrediction
from pydantic import BaseModel

# load model
model = load_mlflow_model(
    # MlFlow model path
    'models:/sklearn_model/1',
    # MlFlow Tracking URI (optional)
    'http://localhost:5000',
)


# Implement deserializer for input data
class WineComposition(BaseModel):
    alcohol: float
    chlorides: float
    citric_acid: float
    density: float
    fixed_acidity: float
    free_sulfur_dioxide: int
    pH: float
    residual_sugar: float
    sulphates: float
    total_sulfur_dioxide: int
    volatile_acidity: int


# implement application
app = ApiBuilder(GenericPrediction(model), WineComposition).build_api()
```

You can then run it with : 

```bash
uvicorn api:app --host 0.0.0.0
```

You can now access your API's documentation, generated by [redoc](https://github.com/Redocly/redoc) on [localhost:8000/redoc]() or  access your API with Swagger on [localhost:8000/docs]() :

![API](https://github.com/gfalcone/mlserve/blob/master/docs/images/mlserve-example.gif)
